<polymer-element name="fa-comic">
    <template>
        <link rel="stylesheet" href="../../bower_components/animate-css/animate.css" noshim />
        <style>

            .comic {
                box-shadow: 0px 5px 15px #3999fc;
                border-radius: 6px
            }
            .full {
                position: absolute;
                left: 0;
                top: 0;
                width: 100%;
                height: 100%;
                text-align: center;

            }

            span {
                font-size: 20px;
                color: #333;
                text-shadow: 1px 1px 0 #b8ceff;
                font-size: 22px;
            }

            #img {
                margin-right: 100px;
                max-width: 100%;
                height: auto;
            }
            @media(max-width: 678px) {
                #img {
                    margin-right: 0px;
                }
            }

        </style>

        <fa-center-content>
            <img id="img"
                class="comic animated fadeInUp"
                src="/comics/regular/Fauna_{{index}}.jpg"
                hidden?="{{loading}}"
                on-load="{{onLoad}}" />

            <div hidden?="{{!loading}}">
                <span class="animated rubberBand infinite">Loading...</span>
            </div>
        </fa-center-content>

        <fa-img-nav on-previous="{{previous}}" on-next="{{next}}"></fa-img-nav>

    </template>
    <script>
        Polymer('fa-comic', {
            index : 0,
            loading : true,
            hash : ['home', ''],

            ready : function() {
                if( window.MAX_IMG ) this.index = MAX_IMG;
                $(window)
                    .on('hashchange', this.update.bind(this))
                this.update();
            },

            update : function() {
                var parts = window.location.hash.split('/');
                parts[0] = parts[0].replace(/#/g, '');

                if( parts[0] != 'home' && parts[0] != '' ) return;

                if( parts.length > 1 && this.index != parts[1] ) {
                    this.index = parts[1];
                } else if( parts.length == 1 ) {
                    this.index = MAX_IMG;
                    this.loading = true;
                }
            },

            previous : function() {
                this.index--;
                if( this.index < 1 ) {
                    this.index = 1;
                    return;
                }
                this.loading = true;
                window.location.hash = 'home/'+this.index;
            },

            next : function() {
                this.index++;
                if( this.index > MAX_IMG ) {
                    this.index = MAX_IMG;
                    return;
                }
                this.loading = true;
                window.location.hash = 'home/'+this.index;
            },

            onLoad : function() {
                this.loading = false;
            }
        });
    </script>
</polymer-element>