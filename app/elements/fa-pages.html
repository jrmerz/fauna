<polymer-element name="fa-pages">
    <template>
        <content></content>
    </template>
    <script>
        Polymer('fa-pages', {
            pages : {},
            cPage : null,

            ready : function() {
                window.addEventListener('polymer-ready', function(e) {

                    for( var i = 0; i < this.children.length; i++ ) {
                        for( var j = 0; j < this.children[i].hash.length; j++ ) {
                            this.pages[this.children[i].hash[j]] = this.children[i];
                            this.children[i].style.display = 'none';
                        }
                    }

                    $(window).on('hashchange', function(){
                        this.update();
                    }.bind(this));

                    this.update();
                }.bind(this));
            },

            update : function() {
                var hash = window.location.hash.replace(/#/g, '');
                if( hash.match(/^!/) ) {
                    window.location = '#'+hash.replace(/^!/, '');
                    return;
                }

                var hash = hash.split('/')[0];

                if( this.pages[hash] && this.pages[hash] != this.cPage ) {
                    if( this.cPage ) this.cPage.style.display = 'none';
                    this.cPage = this.pages[hash];
                    if( hash != 'nuts' && hash != 'home') {
                        window.document.title = 'Fauna - '+hash;
                    }
                    this.cPage.style.display = 'block';
                }
            }
        });
    </script>
</polymer-element>